services:

  mysql:
    image: mysql:8.0.43
    restart: always
    container_name: mysql
    environment:
      MYSQL_DATABASE: sales
      MYSQL_USER: user
      MYSQL_PASSWORD: password
      MYSQL_ROOT_PASSWORD: rootpassword
    volumes:
      - ./data/mysql_database:/var/lib/mysql
      - ./data/mysql_rootfolder:/root/data
    ports:
      - "3306:3306"
    networks:
      capstone-net:
        ipv4_address: 172.30.0.10

  phpmyadmin:
    image: phpmyadmin:5.0
    container_name: phpmyadmin
    restart: always
    ports:
      - "8080:80"
    environment:
      - PMA_ARBITRARY=1
      - PMA_HOST=172.30.0.10
      - PMA_PORT=3306
      - PMA_USER=root
      - PMA_PASSWORD=rootpassword
    networks:
      capstone-net:
        ipv4_address: 172.30.0.11

#  mongo:
#    image: mongo:5.0
#    restart: unless-stopped
#    container_name: mongo
#    environment:
#      MONGO_INITDB_DATABASE: catalog
#      MONGO_INITDB_ROOT_USERNAME: admin
#      MONGO_INITDB_ROOT_PASSWORD: mongoadmin
#    volumes:
#      - ./data/mongo_database:/data/db:rw
#      - ./02-Query-data-in-NoSQL-Databases/mongo_start_scripts/init-mongo.js:/docker-entrypoint-initdb.d/init-mongo.js:ro
#      - ./data/mongo_rootfolder:/root/data:rw
#    ports:
#      - "27017:27017"
#    networks:
#      capstone-net:
#        ipv4_address: 172.30.0.12

  postgres:
    image: postgres:18.0
    restart: always
    container_name: postgres
    shm_size: 128mb
    environment:
      POSTGRES_USER: "postgres"
      POSTGRES_PASSWORD: "postgres"
      POSTGRES_DB: "softcart"
    volumes:
      - ./data/postgres_database:/var/lib/postgresql:rw
      - ./data/postgres_rootfolder:/root/data:rw
    ports:
      - '5432:5432'
    mem_reservation: 128M
    networks:
      capstone-net:
        ipv4_address: 172.30.0.13

  pgadmin:
    image: dpage/pgadmin4
    container_name: pgadmin
    restart: always
    ports:
      - "8087:80"
    depends_on:
      - postgres
    volumes:
      - ./03-Datawarehouse-Postgres/scripts/servers.json:/pgadmin4/servers.json:rw
    environment:
      PGADMIN_DEFAULT_EMAIL: "admin@example.com"
      PGADMIN_DEFAULT_PASSWORD: "postgres"
      PGADMIN_LISTEN_ADDRESS: 0.0.0.0
      PGADMIN_LISTEN_PORT: 80
      POSTGRES_USER: "postgres"
      POSTGRES_PASSWORD: "postgres"
      POSTGRES_DATABASE: "softcart"
    networks:
      capstone-net:
        ipv4_address: 172.30.0.14



networks:
  capstone-net:
    external: true
    name: capstone-net